var t;const e=new((t=class{constructor(t=null){this.size=4,this.score=0,this.status="idle",this.board=t?this.cloneBoard(t):this.createEmptyBoard()}createEmptyBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}cloneBoard(t){return t.map(t=>[...t])}getState(){return this.cloneBoard(this.board)}getScore(){return this.score}getStatus(){return this.status}start(){"idle"===this.status&&(this.status="playing",this.isBoardEmpty()&&(this.addRandomTile(),this.addRandomTile()))}restart(){this.score=0,this.status="playing",this.board=this.createEmptyBoard(),this.addRandomTile(),this.addRandomTile()}isBoardEmpty(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0!==this.board[t][e])return!1;return!0}moveLeft(){this.makeMove(this.mergeRowLeft.bind(this))}moveRight(){this.makeMove(t=>this.mergeRowLeft(t.reverse()).reverse())}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}makeMove(t){let e=JSON.stringify(this.board);for(let e=0;e<this.size;e++)this.board[e]=t(this.board[e]);JSON.stringify(this.board)!==e&&(this.addRandomTile(),this.checkGameStatus())}mergeRowLeft(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);return e.filter(t=>0!==t).concat(Array(this.size).fill(0)).slice(0,this.size)}transpose(){let t=this.createEmptyBoard();for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)t[s][e]=this.board[e][s];this.board=t}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push([e,s]);if(0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}checkGameStatus(){this.board.some(t=>t.includes(2048))?this.status="win":this.canMove()||(this.status="lose")}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){let s=this.board[t][e];if(0===s||e<this.size-1&&s===this.board[t][e+1]||t<this.size-1&&s===this.board[t+1][e])return!0}return!1}}).__esModule?t.default:t),s=document.querySelectorAll(".field-cell"),i=document.querySelector(".start"),r=document.querySelector(".game-score"),a=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),d=document.querySelector(".message-start");function l(){let t=e.getState();s.forEach((e,s)=>{let i=t[Math.floor(s/4)][s%4];e.textContent=0===i?"":i,e.className="field-cell",i&&(e.classList.add(`field-cell--${i}`),e.classList.add("field-cell--merged"),setTimeout(()=>e.classList.remove("field-cell--merged"),150))}),r.textContent=e.getScore(),a.classList.toggle("hidden","win"!==e.getStatus()),o.classList.toggle("hidden","lose"!==e.getStatus())}i.addEventListener("click",()=>{"idle"===e.getStatus()?(e.start(),d.classList.add("hidden"),i.textContent="Restart",i.classList.remove("start"),i.classList.add("restart"),l()):(e.restart(),d.classList.add("hidden"),a.classList.add("hidden"),o.classList.add("hidden"),l())}),document.addEventListener("keydown",t=>{let s=t.key,i=JSON.stringify(e.getState());switch(s){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;default:return}JSON.stringify(e.getState())!==i&&l()});
//# sourceMappingURL=2048-finished.cbdf3934.js.map
