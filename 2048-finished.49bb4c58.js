!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,r)}}"use strict";var r,i=new((r=function(){var r;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");this.size=4,this.score=0,this.status="idle",this.board=t?this.cloneBoard(t):this.createEmptyBoard()}return r=[{key:"createEmptyBoard",value:function(){var t=this;return Array.from({length:this.size},function(){return Array(t.size).fill(0)})}},{key:"cloneBoard",value:function(r){return r.map(function(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}},{key:"getState",value:function(){return this.cloneBoard(this.board)}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"===this.status&&(this.status="playing",this.isBoardEmpty()&&(this.addRandomTile(),this.addRandomTile()))}},{key:"restart",value:function(){this.score=0,this.status="playing",this.board=this.createEmptyBoard(),this.addRandomTile(),this.addRandomTile()}},{key:"isBoardEmpty",value:function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)if(0!==this.board[t][e])return!1;return!0}},{key:"moveLeft",value:function(){this.makeMove(this.mergeRowLeft.bind(this))}},{key:"moveRight",value:function(){var t=this;this.makeMove(function(e){return t.mergeRowLeft(e.reverse()).reverse()})}},{key:"moveUp",value:function(){this.transpose(),this.moveLeft(),this.transpose()}},{key:"moveDown",value:function(){this.transpose(),this.moveRight(),this.transpose()}},{key:"makeMove",value:function(t){for(var e=JSON.stringify(this.board),r=0;r<this.size;r++)this.board[r]=t(this.board[r]);JSON.stringify(this.board)!==e&&(this.addRandomTile(),this.checkGameStatus())}},{key:"mergeRowLeft",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=0;r<e.length-1;r++)e[r]===e[r+1]&&(e[r]*=2,this.score+=e[r],e[r+1]=0);return e.filter(function(t){return 0!==t}).concat(Array(this.size).fill(0)).slice(0,this.size)}},{key:"transpose",value:function(){for(var t=this.createEmptyBoard(),e=0;e<this.size;e++)for(var r=0;r<this.size;r++)t[r][e]=this.board[e][r];this.board=t}},{key:"addRandomTile",value:function(){for(var t=[],r=0;r<this.size;r++)for(var i=0;i<this.size;i++)0===this.board[r][i]&&t.push([r,i]);if(0!==t.length){var n,a=(n=t[Math.floor(Math.random()*t.length)],function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r,i,n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(a.push(r.value),a.length!==e);o=!0);}catch(t){s=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(n,2)||e(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],s=a[1];this.board[o][s]=.9>Math.random()?2:4}}},{key:"checkGameStatus",value:function(){this.board.some(function(t){return t.includes(2048)})?this.status="win":this.canMove()||(this.status="lose")}},{key:"canMove",value:function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++){var r=this.board[t][e];if(0===r||e<this.size-1&&r===this.board[t][e+1]||t<this.size-1&&r===this.board[t+1][e])return!0}return!1}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(i.prototype,r),i}())&&r.__esModule?r.default:r),n=document.querySelectorAll(".field-cell"),a=document.querySelector(".start"),o=document.querySelector(".game-score"),s=document.querySelector(".message-win"),u=document.querySelector(".message-lose"),l=document.querySelector(".message-start");function c(){var t=i.getState();n.forEach(function(e,r){var i=t[Math.floor(r/4)][r%4];e.textContent=0===i?"":i,e.className="field-cell",i&&(e.classList.add("field-cell--".concat(i)),e.classList.add("field-cell--merged"),setTimeout(function(){return e.classList.remove("field-cell--merged")},150))}),o.textContent=i.getScore(),s.classList.toggle("hidden","win"!==i.getStatus()),u.classList.toggle("hidden","lose"!==i.getStatus())}a.addEventListener("click",function(){"idle"===i.getStatus()?(i.start(),l.classList.add("hidden"),a.textContent="Restart",a.classList.remove("start"),a.classList.add("restart"),c()):(i.restart(),l.classList.add("hidden"),s.classList.add("hidden"),u.classList.add("hidden"),c())}),document.addEventListener("keydown",function(t){var e=t.key,r=JSON.stringify(i.getState());switch(e){case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight();break;case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown();break;default:return}JSON.stringify(i.getState())!==r&&c()})}();
//# sourceMappingURL=2048-finished.49bb4c58.js.map
